CREATE OR REPLACE TABLE `crack-celerity-435208-v5.real_estate_sales_db.dim_remarks` (
    remark_id INT64,
    assessor_remark STRING,
    opm_remark STRING,
    PRIMARY KEY(remark_id) NOT ENFORCED
);

INSERT `crack-celerity-435208-v5.real_estate_sales_db.dim_remarks`
SELECT 
    DENSE_RANK() OVER(ORDER BY assessor_remarks, opm_remarks) AS remark_id,
    assessor_remarks,
    opm_remarks
FROM
    (
    SELECT
        assessor_remarks,
        opm_remarks
    FROM
        `crack-celerity-435208-v5.real_estate_sales_db.source_table`
    GROUP BY
        assessor_remarks,
        opm_remarks
)
